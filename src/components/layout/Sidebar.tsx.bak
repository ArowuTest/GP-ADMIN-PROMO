// src/components/layout/Sidebar.tsx
import React from 'react';
import { Link, useLocation } from 'react-router-dom';
import { usePermission } from '../../hooks/usePermission';
import './Sidebar.css';

interface NavItem {
  path: string;
  label: string;
  icon: string;
  permissionCheck: () => boolean;
}

const Sidebar: React.FC = () => {
  const location = useLocation();
  const { 
    canManageDraws, 
    canUploadParticipants, 
    canManagePrizeStructures, 
    canManageUsers, 
    canViewWinners 
  } = usePermission();
  
  const navItems: NavItem[] = [
    {
      path: '/dashboard',
      label: 'Dashboard',
      icon: 'dashboard',
      permissionCheck: () => true // Everyone can access dashboard
    },
    {
      path: '/draw-management',
      label: 'Draw Management',
      icon: 'casino',
      permissionCheck: canManageDraws
    },
    {
      path: '/participant-management',
      label: 'Participants',
      icon: 'people',
      permissionCheck: canUploadParticipants
    },
    {
      path: '/prize-structure',
      label: 'Prize Structure',
      icon: 'emoji_events',
      permissionCheck: canManagePrizeStructures
    },
    {
      path: '/user-management',
      label: 'User Management',
      icon: 'manage_accounts',
      permissionCheck: canManageUsers
    },
    {
      path: '/reports',
      label: 'Reports',
      icon: 'assessment',
      permissionCheck: canViewWinners
    }
  ];

  return (
    <aside className="app-sidebar">
      <nav className="sidebar-nav">
        <ul className="nav-list">
          {navItems.map((item) => (
            item.permissionCheck() && (
              <li key={item.path} className="nav-item">
                <Link 
                  to={item.path} 
                  className={`nav-link ${location.pathname === item.path ? 'active' : ''}`}
                >
                  <span className="material-icons">{item.icon}</span>
                  <span className="nav-label">{item.label}</span>
                </Link>
              </li>
            )
          ))}
        </ul>
      </nav>
      <div className="sidebar-footer">
        <div className="version">v1.0.0</div>
      </div>
    </aside>
  );
};

export default Sidebar;
